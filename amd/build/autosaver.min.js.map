{"version":3,"file":"autosaver.min.js","sources":["../src/autosaver.js"],"sourcesContent":["\n\n/**\n * Storage helper for the Moodle Tiny Autosave plugin.\n *\n * @module      tiny_keylogger/plugin\n * @copyright   2023 kuldeep singh <kuldeep@palinfocom.com>\n * @license     eLearningstack\n */\n\nimport { call } from 'core/ajax';\n\nexport const register = (editor) => {\n    const postOne = (methodname, args) => call([{\n        methodname,\n        args,\n    }])[0];\n    const sendKeyEvent=(event, ed)=>{\n         let ur = ed.srcElement.baseURI;\n         let parm = new URL(ur);\n         let recourceId=0;\n         let modulename=\"\";\n        let cmid=0;\n         if (ur.includes(\"attempt.php\")||ur.includes(\"forum\")||ur.includes(\"assign\")){\n            //return true;\n         }else{\n            return false;\n         }\n         if (ur.includes(\"forum\")||ur.includes(\"assign\")) {\n            cmid=parm.searchParams.get('id');\n        }else{\n            cmid=parm.searchParams.get('cmid');\n            recourceId=parm.searchParams.get('attempt');\n        }\n        if(recourceId===null){\n            recourceId=0;\n        }\n        if(cmid===null){ cmid=0;}\n        if (ur.includes(\"forum\")){\n            modulename=\"forum\";\n        }\n        if (ur.includes(\"assign\")){\n            modulename=\"assign\";\n        }\n        if (ur.includes(\"attempt\")){\n            modulename=\"attempt\";\n        }\n        postOne('keylogger_json', {\n            key: ed.key,\n            event: event,\n            keyCode: ed.keyCode,\n            resourceId: recourceId,\n            cmid:cmid,\n            modulename:modulename\n        });\n\n    };\n    editor.on('keyUp', (editor) => {\n        sendKeyEvent(\"keyUp\", editor);\n    });\n    editor.on('keyDown', (editor) => {\n        sendKeyEvent(\"keyDown\", editor);\n    });\n\n    editor.on('init', () => {\n        // Setup the Undo handler.\n    });\n};\n"],"names":["editor","sendKeyEvent","event","ed","ur","srcElement","baseURI","parm","URL","recourceId","modulename","cmid","includes","methodname","args","searchParams","get","key","keyCode","resourceId","on"],"mappings":"uLAYyBA,eAKfC,aAAa,CAACC,MAAOC,UAClBC,GAAKD,GAAGE,WAAWC,QACnBC,KAAO,IAAIC,IAAIJ,IACfK,WAAW,EACXC,WAAW,GACZC,KAAK,OACJP,GAAGQ,SAAS,gBAAgBR,GAAGQ,SAAS,UAAUR,GAAGQ,SAAS,kBAGxD,EAbC,IAACC,WAAYC,KAepBV,GAAGQ,SAAS,UAAUR,GAAGQ,SAAS,UACnCD,KAAKJ,KAAKQ,aAAaC,IAAI,OAE3BL,KAAKJ,KAAKQ,aAAaC,IAAI,QAC3BP,WAAWF,KAAKQ,aAAaC,IAAI,YAErB,OAAbP,aACCA,WAAW,GAEL,OAAPE,OAAcA,KAAK,GAClBP,GAAGQ,SAAS,WACZF,WAAW,SAEXN,GAAGQ,SAAS,YACZF,WAAW,UAEXN,GAAGQ,SAAS,aACZF,WAAW,WAhCFG,WAkCL,iBAlCiBC,KAkCC,CACtBG,IAAKd,GAAGc,IACRf,MAAOA,MACPgB,QAASf,GAAGe,QACZC,WAAYV,WACZE,KAAKA,KACLD,WAAWA,aAxCmB,cAAK,CAAC,CACxCG,WAAAA,WACAC,KAAAA,QACA,IAyCJd,OAAOoB,GAAG,SAAUpB,SAChBC,aAAa,QAASD,WAE1BA,OAAOoB,GAAG,WAAYpB,SAClBC,aAAa,UAAWD,WAG5BA,OAAOoB,GAAG,QAAQ"}